<div data-controller="pomodoro" data-pomodoro-title-base-value="<%= t("pomodoro.title_base") %>" data-pomodoro-default-label-value="<%= t("home.default_label") %>" data-pomodoro-default-note-value="<%= t("home.default_note") %>" data-pomodoro-finish-title-value="<%= t("home.finish_notify_title") %>" class="grid gap-6">
  <div class="rounded-xl ring-1 ring-emerald-200 bg-white p-6 flex flex-col items-center gap-4">
    <div class="text-7xl font-bold tracking-wide text-emerald-700" data-pomodoro-target="display"><%= t("home.timer_display_default") %></div>
    <div class="flex items-center gap-3">
      <label class="text-sm text-slate-600"><%= t("home.work_minutes_label") %></label>
      <input type="number" min="1" max="180" step="1" value="25" data-pomodoro-target="minutes" class="w-20 rounded-lg ring-1 ring-slate-200 p-2 text-center">
      <button data-action="pomodoro#setMinutes" class="px-3 py-2 rounded-lg bg-emerald-100 text-emerald-700"><%= t("home.apply") %></button>
      <label class="ml-4 inline-flex items-center gap-2 text-sm text-slate-600">
        <input type="checkbox" data-pomodoro-target="wakeToggle" data-action="pomodoro#toggleWakeLock">
        <span><%= t("home.wake_lock_label") %></span>
      </label>
    </div>
    <div class="fixed inset-x-0 bottom-0 md:static md:bottom-auto md:inset-auto px-4 pb-4 md:p-0">
      <div class="mx-auto max-w-5xl rounded-xl ring-1 ring-emerald-200 bg-white p-3 md:p-0 shadow md:shadow-none" style="padding-bottom: env(safe-area-inset-bottom)">
        <div class="flex gap-3 justify-center">
          <button data-action="pomodoro#start" class="px-4 py-3 rounded-lg bg-emerald-600 text-white active:scale-[0.98]"><%= t("home.start") %></button>
          <button data-action="pomodoro#pause" class="px-4 py-3 rounded-lg bg-emerald-100 text-emerald-700 active:scale-[0.98]"><%= t("home.pause") %></button>
          <button data-action="pomodoro#resume" class="px-4 py-3 rounded-lg bg-emerald-100 text-emerald-700 active:scale-[0.98]"><%= t("home.resume") %></button>
          <button data-action="pomodoro#reset" class="px-4 py-3 rounded-lg bg-red-100 text-red-700 active:scale-[0.98]"><%= t("home.reset") %></button>
        </div>
      </div>
    </div>
    <input type="hidden" data-pomodoro-target="csrf" value="<%= form_authenticity_token %>">
  </div>

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
    <div class="rounded-xl ring-1 ring-emerald-200 bg-white p-6">
      <div class="text-sm text-slate-500"><%= t("home.total") %></div>
      <div class="mt-2 text-3xl font-bold text-emerald-700"><%= @total_count %></div>
    </div>
    <div class="rounded-xl ring-1 ring-emerald-200 bg-white p-6">
      <div class="text-sm text-slate-500"><%= t("home.today") %></div>
      <div class="mt-2 text-3xl font-bold text-emerald-700"><%= @today_count %></div>
    </div>
    <div class="rounded-xl ring-1 ring-emerald-200 bg-white p-6">
      <div class="text-sm text-slate-500">Calendar</div>
      <div class="mt-2">
        <a href="/calendar" class="text-emerald-600"><%= t("home.calendar_link") %></a>
      </div>
    </div>
  </div>

  <div class="rounded-xl ring-1 ring-emerald-200 bg-white p-6">
    <div class="flex items-center gap-2">
      <div class="text-slate-600"><%= t("home.recent") %></div>
    </div>
    <div class="mt-4 flex flex-wrap gap-2">
      <% @recent_sessions.each do |s| %>
        <div class="flex items-center gap-2 px-3 py-2 rounded-lg bg-emerald-50">
          <span>üçÖ</span>
          <span class="text-sm text-slate-600"><%= s.label.presence || s.ended_at.strftime("%m-%d %H:%M") %></span>
        </div>
      <% end %>
    </div>
  </div>

  <dialog data-pomodoro-target="dialog" class="rounded-xl p-0">
    <form method="dialog" class="p-6 w-80">
      <div class="text-lg font-semibold text-emerald-700"><%= t("home.dialog_title") %></div>
      <div class="mt-4 grid gap-3">
        <input type="text" placeholder="<%= t("home.label_placeholder") %>" data-pomodoro-target="label" class="w-full rounded-lg ring-1 ring-slate-200 p-2">
        <textarea placeholder="<%= t("home.note_placeholder") %>" data-pomodoro-target="note" class="w-full rounded-lg ring-1 ring-slate-200 p-2"></textarea>
      </div>
      <div class="mt-4 flex justify-end gap-3">
        <button value="cancel" class="px-3 py-2 rounded-lg bg-slate-100"><%= t("home.cancel") %></button>
        <button value="default" data-action="pomodoro#save" class="px-3 py-2 rounded-lg bg-emerald-600 text-white"><%= t("home.save") %></button>
      </div>
    </form>
  </dialog>
</div>
<% content_for :title, t("site.name") %>
<% content_for :description, t("seo.description.home") %>
